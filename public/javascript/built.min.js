/*! node-authentication 2015-01-21 */
var gigster={}||gigster;gigster.dataCalls={artistLookup:function(){$(".venue-check").on("click",$("div"),function(){return $.post(gigster.dataCalls.apiUrl("venue",$(this).prev().val()),function(a){var b=a.results.venuematches.venue[0];$('[name="venueLat"]').val(b.location["geo:point"]["geo:lat"]),$('[name="venueLong"]').val(b.location["geo:point"]["geo:long"])}),!1})},apiUrl:function(a,b){switch(a){case"artist":return"http://ws.audioscrobbler.com/2.0/?method=artist.search&artist="+b+"&api_key=87a726f5832926366bd09f6a3935d792&format=json";case"venue":return"http://ws.audioscrobbler.com/2.0/?method=venue.search&api_key=6de16c25e43a12240c4547fae1b18b13&venue="+b+"&format=json"}},update:function(){$(".action-update").on("click",$(".ticket-container"),function(){var a=$(this).parents("li"),b=$(this),c=$("#update-gig").find("form"),d=a.find(".artist-name").text(),e=a.find(".venue-name").text(),f=a.data("lat"),g=a.data("long");return c.attr("action",b.attr("href")),c.find('[name="artist"]').val(d),c.find('[name="venue"]').val(e),c.find('[name="venueLat"]').val(f),c.find('[name="venueLong"]').val(g),!1}),$(".ticket-artist").blur(function(){})},loadBands:function(){$(".ticket-artist .artist-name")},loadSetlist:function(){for(var a=$("#past-gigs").find(".ticket-container"),b="",c="",d=0;d<a.length;d++)b=$(a[d]).find(".artist-name").text(),c=$(a[d]).parent().data("date"),reformatDate=new Date(c),reformatDate=reformatDate.getDate()+"-"+("0"+(reformatDate.getMonth()+1)).slice(-2)+"-"+reformatDate.getFullYear(),gig=$(a[d]),function(){$.getJSON("http://api.setlist.fm/rest/0.1/search/setlists.json?artistName="+b+"&date="+reformatDate+"&callback=?gigster.dataCalls.printSetlist",{dataType:"jsonp"})}(gig)},printSetlist:function(){console.log("test")}},gigster.internalApiCalls={},gigster.utilities={actionForm:function(){$("[data-action-form]").click(function(){$("#"+$(this).data("action-form")).toggle()})},formatDate:function(){for(var a=$(".display-date").find("span"),b="",c=0;c<a.length;c++)$(a[c]).hasClass("past-date")?(b="<span class='weekday'>"+$(a[c]).text().substring(0,3)+" </span>",b+="<span class='day'> "+$(a[c]).text().substring(8,11)+"</span>",b+="<span class='month'>"+$(a[c]).text().substring(4,7)+"</span>",b+="<span class='year'> "+$(a[c]).text().substring(13,15)+"</span>"):(b="<div class='date-sticker'>",b+="<span class='weekday'>"+$(a[c]).text().substring(0,3)+" </span>",b+="<span class='day'>"+$(a[c]).text().substring(8,11)+"</span>",b+="<span class='month'>"+$(a[c]).text().substring(4,7)+"</span>",b+="</div>"),$(a[c]).html(b)}},gigster.ui={popup:function(){$('[data-trigger="popup"]').on("click",function(){function a(){b.fadeOut("fast"),c.fadeOut("fast",function(){c.remove()})}var b=$(".popup"),c=$('<div class="popup-shadow" style="height:'+$(document).height()+'px;"></div>');c.appendTo("body").fadeIn(),c.on("click",function(){a()}),$(document).keyup(function(b){27==b.keyCode&&a()})})},maps:function(){var a=$(".map-container");a.click(function(){var a=$(this);a.hasClass("active")?(a.removeClass("map-expanded"),a.addClass("map-minified"),a.data("toggle",!0),a.removeClass("active")):(a.removeClass("map-minified"),a.addClass("map-expanded"),a.data("toggle",!1),a.addClass("active"))})},artistFiller:function(){for(var a=$("[data-filler]"),b=0;b<$("[data-filler]").length;b++){var c=$(a[b]),d=c.data("filler");c.animate({width:d+"%"},1e3)}},notificationCount:function(){var a=$(".notification"),b=a.length,c=$(".notification-badge"),d=$(".notification-bubble span");if(b>0){for(var e=0;b>e;e++)c.text(b),d.text(b);c.removeClass("hide")}}},$(function(){gigster.utilities.formatDate(),gigster.utilities.actionForm(),gigster.dataCalls.artistLookup(),gigster.dataCalls.update(),gigster.dataCalls.loadBands(),gigster.dataCalls.loadSetlist(),gigster.ui.popup(),gigster.ui.maps(),gigster.ui.artistFiller(),gigster.ui.notificationCount(),$(".datepicker").datepicker(),$('[name="gig_date"]').datepicker()}());